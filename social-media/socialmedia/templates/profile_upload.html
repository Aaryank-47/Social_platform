{% load static %}

<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" style="max-width: 500px;">
        <div class="modal-content" style="border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); background-color: #fff;">
            <div class="modal-header" style="border-bottom: 1px solid #ddd; background-color: #f8f9fa; color: #333; font-family: 'Roboto', sans-serif;">
                <h1 class="modal-title fs-5" id="exampleModalLabel" style="font-family: 'Roboto', sans-serif; font-weight: 500; color: #333;">New Post</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style="padding: 20px; font-family: 'Roboto', sans-serif;">
                <form action="/upload" method="POST" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="mb-3">
                        <img src="{% static 'css/upload.png' %}" alt="Upload Image" class="img-fluid mx-auto d-block" style="max-width: 80px; margin-bottom: 15px;">
                        <label for="recipient-name" class="col-form-label" style="font-size: 1.1em; font-weight: 500; color: #333;">Photo</label>
                        <input type="file" name="image_upload" class="form-control" id="recipient-name" style="border-radius: 5px; border: 1px solid #ddd; padding: 10px 15px;">
                    </div>
                    <div class="mb-3">
                        <label for="message-text" class="col-form-label" style="font-size: 1.1em; font-weight: 500; color: #333;">Caption</label>
                        <textarea class="form-control" name="caption" placeholder="Add your caption..." id="message-text" style="border-radius: 5px; border: 1px solid #ddd; padding: 10px; font-size: 1em;"></textarea>
                    </div>
                    
                    {# Add Allowed Viewers Selection #}
                    <div class="mb-3">
                        <label for="allowed_viewers_select" class="col-form-label" style="font-size: 1.1em; font-weight: 500; color: #333;">Visible To (Optional - Default: All Connections)</label>
                        <select multiple class="form-select" name="allowed_viewers" id="allowed_viewers_select" size="5" style="border-radius: 5px; border: 1px solid #ddd; padding: 10px;">
                            {% if connections %}
                                {% for connection in connections %}
                                <option value="{{ connection.id }}">@{{ connection.username }}</option>
                                {% endfor %}
                            {% else %}
                                <option disabled>No connections to select.</option>    
                            {% endif %}
                        </select>
                        <small class="form-text text-muted">Hold Ctrl/Cmd to select multiple users. If none selected, post is visible to all connections.</small>
                    </div>
                    {# End Allowed Viewers Selection #}
            </div>
            <div class="modal-footer" style="border-top: 1px solid #ddd; padding: 15px 20px; background-color: #f8f9fa;">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="font-weight: 600; color: #666; border: 1px solid #ddd; background-color: transparent;">Close</button>
                <button type="submit" class="btn btn-primary" style="font-weight: 600; background-color: #007bff; border-color: #007bff;">Create Post</button>
            </div>
            </form>
        </div>
    </div>
</div> 